# 模版元编程

## 什么是模版元编程

模版元编程的本质就是利用模版的图灵完备性在编译的时候进行代码生成，从而实现对泛型编程的支持。

## 应用场景

### 编译时计算

比如这里通过编译时计算阶乘, 得到的设计静态常量

```c++
template <unsigned N>
struct Factorial {
    static_assert(N > 0, "Factorial argument must be positive");
    static const unsigned value = N * Factorial<N-1>::value;
};

template <>
struct Factorial<0> {
    static const unsigned value = 1;
};
```

### 类型检测

在编译时配合`constexpr`进行类型检测
```c++
template <typename T>
struct is_pointer
{
    static constexpr bool value = false;
};


template <typename T>
struct is_pointer<T*>
{
    static constexpr bool value = true;
};

template <typename T>
constexpr bool is_pointer_v = is_pointer<T>::value;

int main()
{
    if constexpr (is_pointer_v<int>) {
        std::cout << "int is a pointer\n";
    }
    else {
        std::cout << "int is not a pointer\n";
    }
    if constexpr (is_pointer_v<int*>)
    {
        std::cout << "int* is a pointer\n";
    }
    else 
    {
        std::cout << "int* is not a pointer\n";
    }
    return 0;
}
```

### 类型擦除

1. 删除const属性
    ```c++
    template <typename T>
    struct remove_const
    {
        using type = T;
    };

    template <typename T>
    struct remove_const<const T>
    {
        using type = T;
    };
    ```
